"use client";

import Filter from "@/components/Filter";
import Footer from "@/components/Footer";
import Header from "@/components/Header";
import ProductCard from "@/components/ProductCard";
import SpecialOffer from "@/components/SpecialOffer";
import Head from "next/head";
import { useState } from "react";

const page = () => {
  const [cartItems, setCartItems] = useState([]);
  const [filters, setFilters] = useState({
    category: "",
    priceRange: "",
    organic: false,
  });

  const categories = ["Vegetables", "Fruits", "Beans", "Herbs", "Nuts"];

  const products = [
    {
      id: 1,
      title: "Organic Tomatoes",
      price: 11.99,
      category: "Vegetables",
      organic: true,
      image: "/images/tomatoes.jpg",
      variants: [
        { name: "Cherry", price: 1.5 },
        { name: "Beefsteak", price: 2.0 },
        { name: "Heirloom", price: 3.0 },
      ],
    },
    {
      id: 2,
      title: "Fresh Mangoes",
      price: 15.99,
      category: "Fruits",
      organic: false,
      image: "/images/mangoes.jpg",
      variants: [
        { name: "Alphonso", price: 2.5 },
        { name: "Kent", price: 1.5 },
        { name: "Ataulfo", price: 2.0 },
      ],
    },
    {
      id: 3,
      title: "Black Beans",
      price: 8.99,
      category: "Beans",
      organic: true,
      image: "/images/beans.jpg",
      variants: [
        { name: "1 kg", price: 0 },
        { name: "2.5 kg", price: -2.0 },
        { name: "5 kg", price: -4.0 },
      ],
    },
    {
      id: 4,
      title: "Organic Basil",
      price: 6.99,
      category: "Herbs",
      organic: true,
      image: "/images/basil.jpg",
      variants: [
        { name: "Small", price: 0 },
        { name: "Large", price: 2.0 },
      ],
    },
    {
      id: 5,
      title: "Almonds",
      price: 12.99,
      category: "Nuts",
      organic: false,
      image: "/images/almonds.jpg",
      variants: [
        { name: "Raw", price: 0 },
        { name: "Roasted", price: 1.0 },
      ],
    },
    {
      id: 6,
      title: "Organic Spinach",
      price: 5.99,
      category: "Vegetables",
      organic: true,
      image: "/images/spinach.jpg",
      variants: [
        { name: "Bunch", price: 0 },
        { name: "Bag", price: 1.5 },
      ],
    },
  ];

  const addToCart = (product) => {
    setCartItems((prevItems) => {
      const existingItem = prevItems.find(
        (item) =>
          item.id === product.id &&
          item.selectedVariant?.name === product.selectedVariant?.name
      );

      if (existingItem) {
        return prevItems.map((item) =>
          item.id === product.id &&
          item.selectedVariant?.name === product.selectedVariant?.name
            ? { ...item, quantity: item.quantity + 1 }
            : item
        );
      } else {
        return [...prevItems, { ...product, quantity: 1 }];
      }
    });
  };

  const removeFromCart = (index) => {
    setCartItems((prevItems) => {
      const newItems = [...prevItems];
      newItems.splice(index, 1);
      return newItems;
    });
  };

  const filterProducts = () => {
    return products.filter((product) => {
      // Category filter
      if (filters.category && product.category !== filters.category) {
        return false;
      }

      // Price range filter
      if (filters.priceRange) {
        const [min, max] = filters.priceRange.split("-").map(Number);
        const price = product.price + (product.variants[0]?.price || 0);

        if (filters.priceRange.endsWith("+")) {
          if (price < parseInt(filters.priceRange)) return false;
        } else if (price < min || price > max) {
          return false;
        }
      }

      // Organic filter
      if (filters.organic && !product.organic) {
        return false;
      }

      return true;
    });
  };

  const filteredProducts = filterProducts();

  return (
    <div>
      <Head>
        <title>OrganicHarvest - Healthy Super Organic Produce</title>
        <meta
          name="description"
          content="Providing healthy super organic produce"
        />
      </Head>

      <Header cartItems={cartItems} removeFromCart={removeFromCart} />

      <section className="hero">
        <div className="container flex flex-col items-center">
          <h1 className="hero-faizal">
            <svg
              width="200"
              height="200"
              viewBox="0 0 166 51"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M7.8125 48.5C7.72917 48.4583 7.5625 48.3125 7.3125 48.0625C7.0625 47.8125 6.91667 47.625 6.875 47.5C6.66667 44.7083 6.72917 41.875 7.0625 39C7.39583 36.0833 7.72917 33.1667 8.0625 30.25C8.4375 27.3333 8.66667 24.4375 8.75 21.5625C8.83333 18.6875 8.52083 15.8542 7.8125 13.0625L7.3125 11.125H1.4375C1.0625 11.125 0.8125 10.9792 0.6875 10.6875C0.5625 10.3542 0.5 10 0.5 9.625C0.5 9.20833 0.541667 8.8125 0.625 8.4375C0.75 8.0625 0.854167 7.79167 0.9375 7.625C1.02083 7.54167 1.10417 7.4375 1.1875 7.3125C1.3125 7.1875 1.39583 7.125 1.4375 7.125H7.3125V3.6875C7.3125 2.9375 7.47917 2.66667 7.8125 2.875C8.1875 3.04167 8.58333 3.39583 9 3.9375C9.41667 4.4375 9.8125 5 10.1875 5.625C10.5625 6.20833 10.75 6.54167 10.75 6.625C13 6.95833 15.2292 7.14583 17.4375 7.1875C19.6875 7.1875 21.9167 7.10417 24.125 6.9375C26.3333 6.72917 28.5417 6.47917 30.75 6.1875C32.9583 5.85417 35.1667 5.52083 37.375 5.1875C37.625 5.14583 37.9375 5.22917 38.3125 5.4375C38.7292 5.64583 39.0833 5.91667 39.375 6.25C39.7083 6.54167 39.9375 6.875 40.0625 7.25C40.1875 7.58333 40.1042 7.89583 39.8125 8.1875C39.0625 8.9375 37.9792 9.47917 36.5625 9.8125C35.1458 10.1458 33.5417 10.3542 31.75 10.4375C29.9583 10.5208 28.0417 10.5417 26 10.5C24 10.4583 22.0417 10.4167 20.125 10.375C18.25 10.3333 16.4792 10.3542 14.8125 10.4375C13.1875 10.5208 11.8333 10.75 10.75 11.125C10.8333 14.125 10.8333 17.125 10.75 20.125C10.7083 23.0833 10.625 26.0625 10.5 29.0625C10.4167 32.0625 10.3333 35.0625 10.25 38.0625C10.2083 41.0208 10.2292 44 10.3125 47L9.3125 49C9.27083 49.0833 9.0625 49.0625 8.6875 48.9375C8.3125 48.7708 8.02083 48.625 7.8125 48.5ZM12.75 25.8125C12.6667 25.8125 12.5625 25.75 12.4375 25.625C12.3542 25.5 12.2917 25.4167 12.25 25.375C12.4167 24.9167 12.625 24.4167 12.875 23.875C13.125 23.3333 13.4375 22.8958 13.8125 22.5625C14.1875 22.2292 14.6042 22.0625 15.0625 22.0625C15.5625 22.0208 16.125 22.2917 16.75 22.875C17.2917 22.9167 18.25 22.8542 19.625 22.6875C21.0417 22.5208 22.6458 22.3333 24.4375 22.125C26.2292 21.875 28.1042 21.625 30.0625 21.375C32.0208 21.125 33.8333 20.9167 35.5 20.75C37.1667 20.5833 38.5833 20.5208 39.75 20.5625C40.9167 20.5625 41.6042 20.6875 41.8125 20.9375C42.1458 21.3958 42.0417 21.8542 41.5 22.3125C40.9583 22.7708 40.125 23.2083 39 23.625C37.875 24.0417 36.5208 24.4375 34.9375 24.8125C33.3542 25.1458 31.6875 25.4583 29.9375 25.75C28.1875 26 26.3958 26.2083 24.5625 26.375C22.7708 26.5417 21.0833 26.6458 19.5 26.6875C17.9583 26.6875 16.5833 26.625 15.375 26.5C14.1667 26.375 13.2917 26.1458 12.75 25.8125ZM47 46.6875C46.1667 45.8542 45.5 44.5833 45 42.875C44.5 41.1667 44.1458 39.2292 43.9375 37.0625C43.7708 34.8958 43.75 32.6042 43.875 30.1875C44 27.7292 44.2708 25.3542 44.6875 23.0625C45.1458 20.7292 45.7292 18.5625 46.4375 16.5625C47.1875 14.5625 48.0833 12.9167 49.125 11.625C50.2083 10.2917 51.4167 9.4375 52.75 9.0625C54.125 8.64583 55.6458 8.875 57.3125 9.75C57.8958 10.0833 58.5 10.6458 59.125 11.4375C59.7917 12.2292 60.4167 13.125 61 14.125C61.5833 15.0833 62.0833 16.0625 62.5 17.0625C62.9583 18.0208 63.2917 18.8333 63.5 19.5C63.5417 19.7083 63.5417 20.3542 63.5 21.4375C63.5 22.4792 63.4792 23.75 63.4375 25.25C63.3958 26.75 63.3958 28.4167 63.4375 30.25C63.5208 32.0417 63.6667 33.8125 63.875 35.5625C64.125 37.2708 64.5 38.875 65 40.375C65.5 41.8333 66.1667 43 67 43.875C67.8333 44.7083 68.875 45.1667 70.125 45.25C71.4167 45.2917 72.9792 44.7708 74.8125 43.6875C75.4792 43.1042 75.875 42.5417 76 42C76.125 41.4167 76.1875 40.9375 76.1875 40.5625C76.1875 40.1458 76.2292 39.875 76.3125 39.75C76.3958 39.625 76.7708 39.7292 77.4375 40.0625C78.2708 41.1458 78.5417 42.3125 78.25 43.5625C78 44.7708 77.3958 45.8542 76.4375 46.8125C75.5208 47.7292 74.3542 48.3958 72.9375 48.8125C71.5208 49.1875 70.0625 49.0833 68.5625 48.5C67.1042 47.9167 65.7083 46.7292 64.375 44.9375C63.0417 43.1458 61.9792 40.5417 61.1875 37.125C60.9375 37.8333 60.5417 38.7083 60 39.75C59.5 40.7917 58.8958 41.8333 58.1875 42.875C57.4792 43.9167 56.6667 44.8958 55.75 45.8125C54.875 46.7292 53.9583 47.4167 53 47.875C52.0417 48.3333 51.0417 48.5208 50 48.4375C49 48.3125 48 47.7292 47 46.6875ZM47.5625 42.75C48.2708 44.25 49.1042 45.0625 50.0625 45.1875C51.0208 45.3125 52 44.9375 53 44.0625C54 43.1875 54.9792 41.9167 55.9375 40.25C56.9375 38.5833 57.7708 36.7083 58.4375 34.625C59.1458 32.5 59.6667 30.2917 60 28C60.375 25.6667 60.4375 23.4375 60.1875 21.3125C59.9792 19.1875 59.4375 17.25 58.5625 15.5C57.6875 13.75 56.3542 12.375 54.5625 11.375C54.5208 11.3333 54.4375 11.3125 54.3125 11.3125C54.2292 11.3125 54.1458 11.3125 54.0625 11.3125C52.7708 11.8958 51.6458 12.8958 50.6875 14.3125C49.7292 15.7292 48.8958 17.3958 48.1875 19.3125C47.5208 21.2292 47 23.2917 46.625 25.5C46.25 27.7083 46.0417 29.875 46 32C45.9583 34.125 46.0625 36.1458 46.3125 38.0625C46.5625 39.9375 46.9792 41.5 47.5625 42.75ZM77.5625 47.5C77.4792 47.25 77.4167 46.4167 77.375 45C77.3333 43.5417 77.2917 41.7917 77.25 39.75C77.25 37.7083 77.2708 35.5 77.3125 33.125C77.3542 30.7083 77.3958 28.4583 77.4375 26.375C77.5208 24.25 77.6042 22.4167 77.6875 20.875C77.8125 19.3333 77.9375 18.3542 78.0625 17.9375C78.3125 17.8125 78.5833 17.8125 78.875 17.9375C79.1667 18.0625 79.4167 18.2292 79.625 18.4375C79.875 18.6458 80.0833 18.8958 80.25 19.1875C80.4167 19.4792 80.5 19.7292 80.5 19.9375V47.5C80.5 47.9583 80.375 48.3125 80.125 48.5625C79.875 48.7708 79.5625 48.875 79.1875 48.875C78.8542 48.875 78.5208 48.7708 78.1875 48.5625C77.8958 48.3125 77.6875 47.9583 77.5625 47.5ZM78.0625 8.1875C78.0208 8.0625 77.9792 7.89583 77.9375 7.6875C77.9375 7.4375 77.9375 7.1875 77.9375 6.9375C77.9375 6.64583 77.9375 6.39583 77.9375 6.1875C77.9792 5.9375 78.0208 5.77083 78.0625 5.6875C78.3958 5.52083 78.7708 5.375 79.1875 5.25C79.6042 5.125 80.0417 5.10417 80.5 5.1875C81.2083 6.10417 81.6458 6.85417 81.8125 7.4375C82.0208 7.97917 82.0417 8.41667 81.875 8.75C81.7083 9.04167 81.4167 9.22917 81 9.3125C80.625 9.35417 80.2292 9.33333 79.8125 9.25C79.3958 9.16667 79 9.04167 78.625 8.875C78.2917 8.66667 78.1042 8.4375 78.0625 8.1875ZM93 45.9375C91.9167 45.1875 91.25 44.375 91 43.5C90.75 42.5833 90.75 41.6458 91 40.6875C91.2917 39.7292 91.75 38.75 92.375 37.75C93 36.7083 93.6458 35.6875 94.3125 34.6875C95.0208 33.6875 95.6458 32.75 96.1875 31.875C96.7708 30.9583 97.125 30.1042 97.25 29.3125C97 29.1875 96.7292 29.125 96.4375 29.125C96.1458 29.125 95.8333 29.125 95.5 29.125C95.2083 29.125 94.9167 29.1042 94.625 29.0625C94.3333 29.0208 94.0833 28.875 93.875 28.625C93.375 28.0833 93.125 27.5 93.125 26.875C93.1667 26.25 93.5 25.6875 94.125 25.1875C94.5417 24.8958 94.9792 24.7917 95.4375 24.875C95.8958 24.9583 96.3542 25.125 96.8125 25.375C97.3125 25.5833 97.7917 25.7917 98.25 26C98.75 26.1667 99.2292 26.2083 99.6875 26.125C99.8958 26.0833 100.292 25.7917 100.875 25.25C101.5 24.6667 102.188 23.9583 102.938 23.125C103.729 22.25 104.542 21.3125 105.375 20.3125C106.25 19.3125 107.042 18.375 107.75 17.5C108.5 16.5833 109.146 15.7917 109.688 15.125C110.229 14.4167 110.583 13.9583 110.75 13.75C109.292 12.9583 107.562 12.4792 105.562 12.3125C103.604 12.1042 101.562 12.0625 99.4375 12.1875C97.3542 12.3125 95.2708 12.5208 93.1875 12.8125C91.1458 13.1042 89.3125 13.3125 87.6875 13.4375C86.8125 13.5208 86.25 13.4167 86 13.125C85.7917 12.8333 85.7917 12.5 86 12.125C86.25 11.7083 86.625 11.3125 87.125 10.9375C87.625 10.5625 88.1667 10.3333 88.75 10.25C90.625 10 92.4792 9.85417 94.3125 9.8125C96.1875 9.72917 98.0417 9.72917 99.875 9.8125C101.75 9.85417 103.604 9.9375 105.438 10.0625C107.312 10.1875 109.188 10.2917 111.062 10.375C113.062 10.4167 114.271 10.7292 114.688 11.3125C115.146 11.8542 115.125 12.5833 114.625 13.5C114.125 14.375 113.292 15.375 112.125 16.5C110.958 17.625 109.771 18.7708 108.562 19.9375C107.354 21.1042 106.271 22.2708 105.312 23.4375C104.354 24.5625 103.833 25.5625 103.75 26.4375C104.542 26.9375 105.833 27.2292 107.625 27.3125C109.417 27.3542 111.312 27.3125 113.312 27.1875C115.312 27.0208 117.208 26.8125 119 26.5625C120.792 26.3125 122.104 26.125 122.938 26C123.312 26 123.625 26.1458 123.875 26.4375C124.125 26.6875 124.292 27 124.375 27.375C124.458 27.7083 124.458 28.0625 124.375 28.4375C124.292 28.7708 124.062 29.0417 123.688 29.25C122.854 29.7083 121.854 30.0417 120.688 30.25C119.521 30.4167 118.271 30.5208 116.938 30.5625C115.604 30.6042 114.188 30.5833 112.688 30.5C111.229 30.4167 109.792 30.3333 108.375 30.25C106.958 30.125 105.583 30.0417 104.25 30C102.958 29.9167 101.792 29.9167 100.75 30C98.1667 33.0417 96.4583 35.5625 95.625 37.5625C94.7917 39.5208 94.5833 41.0625 95 42.1875C95.4583 43.2708 96.3958 44 97.8125 44.375C99.2292 44.7083 100.896 44.7708 102.812 44.5625C104.729 44.3542 106.75 43.9375 108.875 43.3125C111 42.6458 112.958 41.875 114.75 41C116.583 40.0833 118.125 39.125 119.375 38.125C120.667 37.0833 121.417 36.0833 121.625 35.125C122.417 34.7917 122.875 34.875 123 35.375C123.167 35.8333 123.167 36.4375 123 37.1875C122.875 37.8958 122.667 38.625 122.375 39.375C122.083 40.0833 121.875 40.5208 121.75 40.6875C120.917 41.6458 119.771 42.5417 118.312 43.375C116.854 44.1667 115.229 44.875 113.438 45.5C111.646 46.125 109.75 46.625 107.75 47C105.75 47.375 103.812 47.6042 101.938 47.6875C100.104 47.7292 98.3958 47.625 96.8125 47.375C95.2708 47.0833 94 46.6042 93 45.9375ZM129.5 46.6875C128.667 45.8542 128 44.5833 127.5 42.875C127 41.1667 126.646 39.2292 126.438 37.0625C126.271 34.8958 126.25 32.6042 126.375 30.1875C126.5 27.7292 126.771 25.3542 127.188 23.0625C127.646 20.7292 128.229 18.5625 128.938 16.5625C129.688 14.5625 130.583 12.9167 131.625 11.625C132.708 10.2917 133.917 9.4375 135.25 9.0625C136.625 8.64583 138.146 8.875 139.812 9.75C140.396 10.0833 141 10.6458 141.625 11.4375C142.292 12.2292 142.917 13.125 143.5 14.125C144.083 15.0833 144.583 16.0625 145 17.0625C145.458 18.0208 145.792 18.8333 146 19.5C146.042 19.7083 146.042 20.3542 146 21.4375C146 22.4792 145.979 23.75 145.938 25.25C145.896 26.75 145.896 28.4167 145.938 30.25C146.021 32.0417 146.167 33.8125 146.375 35.5625C146.625 37.2708 147 38.875 147.5 40.375C148 41.8333 148.667 43 149.5 43.875C150.333 44.7083 151.375 45.1667 152.625 45.25C153.917 45.2917 155.479 44.7708 157.312 43.6875C157.979 43.1042 158.375 42.5417 158.5 42C158.625 41.4167 158.688 40.9375 158.688 40.5625C158.688 40.1458 158.729 39.875 158.812 39.75C158.896 39.625 159.271 39.7292 159.938 40.0625C160.771 41.1458 161.042 42.3125 160.75 43.5625C160.5 44.7708 159.896 45.8542 158.938 46.8125C158.021 47.7292 156.854 48.3958 155.438 48.8125C154.021 49.1875 152.562 49.0833 151.062 48.5C149.604 47.9167 148.208 46.7292 146.875 44.9375C145.542 43.1458 144.479 40.5417 143.688 37.125C143.438 37.8333 143.042 38.7083 142.5 39.75C142 40.7917 141.396 41.8333 140.688 42.875C139.979 43.9167 139.167 44.8958 138.25 45.8125C137.375 46.7292 136.458 47.4167 135.5 47.875C134.542 48.3333 133.542 48.5208 132.5 48.4375C131.5 48.3125 130.5 47.7292 129.5 46.6875ZM130.062 42.75C130.771 44.25 131.604 45.0625 132.562 45.1875C133.521 45.3125 134.5 44.9375 135.5 44.0625C136.5 43.1875 137.479 41.9167 138.438 40.25C139.438 38.5833 140.271 36.7083 140.938 34.625C141.646 32.5 142.167 30.2917 142.5 28C142.875 25.6667 142.938 23.4375 142.688 21.3125C142.479 19.1875 141.938 17.25 141.062 15.5C140.188 13.75 138.854 12.375 137.062 11.375C137.021 11.3333 136.938 11.3125 136.812 11.3125C136.729 11.3125 136.646 11.3125 136.562 11.3125C135.271 11.8958 134.146 12.8958 133.188 14.3125C132.229 15.7292 131.396 17.3958 130.688 19.3125C130.021 21.2292 129.5 23.2917 129.125 25.5C128.75 27.7083 128.542 29.875 128.5 32C128.458 34.125 128.562 36.1458 128.812 38.0625C129.062 39.9375 129.479 41.5 130.062 42.75ZM162.438 48.0625C162.271 47.3958 162.146 46.4792 162.062 45.3125C161.979 44.1458 161.938 42.8542 161.938 41.4375C161.938 39.9792 161.938 38.4583 161.938 36.875C161.979 35.2917 162.021 33.75 162.062 32.25C162.104 30.75 162.104 29.3542 162.062 28.0625C162.062 26.7708 162.021 25.7083 161.938 24.875C161.896 24.25 161.833 23.3333 161.75 22.125C161.708 20.875 161.646 19.4792 161.562 17.9375C161.479 16.3958 161.375 14.7708 161.25 13.0625C161.167 11.3542 161.104 9.72917 161.062 8.1875C161.021 6.60417 161 5.16667 161 3.875C161 2.54167 161.042 1.52083 161.125 0.8125C161.75 0.270833 162.25 0.416667 162.625 1.25C163.042 2.04167 163.354 3.20833 163.562 4.75C163.771 6.25 163.896 7.95833 163.938 9.875C164.021 11.7917 164.062 13.6042 164.062 15.3125C164.062 17.0208 164.042 18.4583 164 19.625C163.958 20.7917 163.938 21.3958 163.938 21.4375C164.146 25.3542 164.271 29.2292 164.312 33.0625C164.396 36.8542 164.604 40.6875 164.938 44.5625C165.354 45.3542 165.562 46.2083 165.562 47.125C165.604 48 165.479 48.7083 165.188 49.25C164.938 49.7917 164.562 50.0208 164.062 49.9375C163.562 49.8542 163.021 49.2292 162.438 48.0625Z"
                fill="white"
              />
            </svg>
          </h1>
          <h1 className="hero-title">
            Providing Healthy Super Organic Produce
          </h1>
          <p className="hero-subtitle">
            Farm-fresh organic products delivered to your doorstep
          </p>
          <a href="/shop" className="btn btn-primary">
            Shop Now
          </a>
        </div>
      </section>

      <section className="special-offer">
        <SpecialOffer addToCart={addToCart} />
      </section>

      <section className="products">
        <div className="container">
          <h2 className="section-title text-2xl">Featured Products</h2>

          {/* <Filter categories={categories} onFilterChange={setFilters} /> */}

          <div className="product-grid">
            {filteredProducts.map((product) => (
              <ProductCard
                key={product.id}
                product={product}
                addToCart={addToCart}
              />
            ))}
          </div>
        </div>
      </section>

      <Footer />
    </div>
  );
};

export default page;
